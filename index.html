<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Stream Timer PRO</title>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>

body{
    margin:0;
    background:transparent;
    font-family:Arial, sans-serif;
    color:white;
}

/* ===== –¢–ê–ô–ú–ï–† ===== */

.timer-box{
    position:absolute;
    top:40px;
    left:40px;
    text-align:center;
    font-size:60px;
    font-weight:bold;
    line-height:1.1;
    background:rgba(0,0,0,0.6);
    padding:25px;
    border-radius:20px;
    box-shadow:0 0 30px #ff0000;
    transition:0.3s;
}

.red{
    color:red;
    text-shadow:0 0 20px red;
}

/* ===== –û–ö–ù–û –î–û–ù–ê–¢–û–í ===== */

.donate-box{
    position:absolute;
    right:40px;
    top:40px;
    width:260px;
    background:rgba(0,0,0,0.7);
    padding:20px;
    border-radius:20px;
    text-align:center;
    box-shadow:0 0 25px #00ff99;
}

.last-donate{
    margin-top:15px;
    font-size:18px;
}

.price-box{
    margin-top:15px;
    font-size:18px;
    color:#00ff99;
}

</style>
</head>
<body>

<div class="timer-box" id="timer">
0–¥<br>00—á<br>00–º<br>00—Å
</div>

<div class="donate-box">
    <div style="font-size:22px;">üíé –î–æ–Ω–∞—Ç—ã</div>
    <div class="last-donate" id="lastDonate">
        –ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ–Ω–∞—Ç:<br>‚Äî –Ω–µ—Ç ‚Äî
    </div>
    <div class="price-box" id="priceBox">
        5‚ÇΩ = 1 –º–∏–Ω—É—Ç–∞
    </div>
</div>

<script>

let totalSeconds = 0;
let pricePerMinute = 5;
let lastDonationId = 0;

// ===== –¢–ê–ô–ú–ï–† =====

function updateTimer(){

    if(totalSeconds > 0){
        totalSeconds--;
    }

    let days = Math.floor(totalSeconds / 86400);
    let hours = Math.floor((totalSeconds % 86400)/3600);
    let minutes = Math.floor((totalSeconds % 3600)/60);
    let seconds = totalSeconds % 60;

    let timerElement = document.getElementById("timer");

    timerElement.innerHTML =
        days + "–¥<br>" +
        String(hours).padStart(2,'0') + "—á<br>" +
        String(minutes).padStart(2,'0') + "–º<br>" +
        String(seconds).padStart(2,'0') + "—Å";

    if(totalSeconds <= 60){
        timerElement.classList.add("red");
    }else{
        timerElement.classList.remove("red");
    }
}

setInterval(updateTimer,1000);

// ===== –î–û–ë–ê–í–õ–ï–ù–ò–ï –í–†–ï–ú–ï–ù–ò =====

function addTime(seconds, nick, minutesAdded){

    totalSeconds += seconds;

    document.getElementById("lastDonate").innerHTML =
        "–ü–æ—Å–ª–µ–¥–Ω–∏–π –¥–æ–Ω–∞—Ç:<br><b style='color:#00ff99'>" +
        nick + "</b> +" + minutesAdded + " –º–∏–Ω";

    document.querySelector(".timer-box").style.transform="scale(1.1)";
    setTimeout(()=>{
        document.querySelector(".timer-box").style.transform="scale(1)";
    },300);
}

// ===== –ü–†–û–í–ï–†–ö–ê –î–û–ù–ê–¢–û–í =====

async function checkDonations(){

    try{

        const response = await fetch("https://www.donationalerts.com/api/v1/alerts/donations?limit=1", {
            headers:{
                "Authorization": "Bearer Zvk2S9bNr4AujcccGrTs"
            }
        });

        const data = await response.json();

        if(!data.data || data.data.length === 0) return;

        const donation = data.data[0];

        if(donation.id === lastDonationId) return;

        lastDonationId = donation.id;

        const nick = donation.username;
        const amount = parseFloat(donation.amount);

        const minutesAdded = Math.floor(amount / pricePerMinute);
        if(minutesAdded <= 0) return;

        addTime(minutesAdded * 60, nick, minutesAdded);

        console.log("–î–æ–Ω–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω:", donation);

    }catch(e){
        console.log("–û—à–∏–±–∫–∞ API:", e);
    }
}

setInterval(checkDonations,5000);

</script>

</body>
</html>
