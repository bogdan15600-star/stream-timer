<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Stream Timer PRO+ Live</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600;800&display=swap" rel="stylesheet">
<script src="https://socket.donationalerts.ru/socket.io/socket.io.js"></script>

<style>
body{
    margin:0;
    background:transparent;
    font-family:'Orbitron',sans-serif;
    display:flex;
    flex-direction:column;
    justify-content:space-between;
    height:100vh;
    color:white;
}

.main{
    display:flex;
    justify-content:center;
    align-items:flex-start;
    gap:40px;
    margin-top:30px;
}

.timer{
    display:flex;
    flex-direction:column;
    gap:12px;
}

.time-block{
    background:linear-gradient(145deg,#111,#222);
    padding:20px 50px;
    border-radius:25px;
    box-shadow:0 0 25px rgba(0,255,200,0.3);
    text-align:center;
}

.number{
    font-size:65px;
    font-weight:800;
    color:#00ffd0;
}

.label{
    font-size:18px;
    opacity:0.7;
}

.danger .number{
    color:#ff2e2e;
    text-shadow:0 0 15px red;
}

.donation-window{
    width:280px;
    display:flex;
    flex-direction:column;
    gap:12px;
    background:linear-gradient(145deg,#0f0f0f,#1c1c1c);
    padding:20px;
    border-radius:25px;
    box-shadow:0 0 25px rgba(0,255,150,0.2);
}

.donation-title{
    text-align:center;
    font-size:20px;
    color:#00ff88;
}

.donation-item{
    background:#151515;
    padding:12px;
    border-radius:15px;
    font-size:14px;
}

.highlight{
    color:#00ff88;
}

.price-tag{
    margin-top:10px;
    padding:12px;
    border-radius:15px;
    background:#002018;
    text-align:center;
    color:#00ff88;
    font-weight:bold;
    transition:0.3s;
}

.price-boost{ animation:priceUp 0.6s ease; }
.price-drop{ animation:priceDown 0.6s ease; }

@keyframes priceUp{
    0%{transform:scale(1);}
    50%{transform:scale(1.15);}
    100%{transform:scale(1);}
}

@keyframes priceDown{
    0%{transform:scale(1);}
    50%{transform:scale(0.85);}
    100%{transform:scale(1);}
}

.price-popup{
    text-align:center;
    font-size:14px;
    padding:6px;
    border-radius:10px;
    opacity:0;
    transition:0.4s;
}

.price-popup.show{
    opacity:1;
}

.admin{
    width:100%;
    background:linear-gradient(#1a0000,#300000);
    border-top:3px solid red;
    padding:15px;
    color:#ff4d4d;
    font-size:14px;
}

.admin button{
    background:red;
    border:none;
    padding:5px 10px;
    margin:3px;
    color:white;
    cursor:pointer;
    font-weight:bold;
}

.admin button:hover{
    background:#cc0000;
}
</style>
</head>
<body>

<div class="main">

<div id="timer" class="timer">
    <div class="time-block"><div id="days" class="number">00</div><div class="label">–î–ù–ò</div></div>
    <div class="time-block"><div id="hours" class="number">00</div><div class="label">–ß–ê–°–´</div></div>
    <div class="time-block"><div id="minutes" class="number">00</div><div class="label">–ú–ò–ù–£–¢–´</div></div>
    <div class="time-block"><div id="seconds" class="number">00</div><div class="label">–°–ï–ö–£–ù–î–´</div></div>
</div>

<div class="donation-window">
    <div class="donation-title">–î–û–ù–ê–¢–´</div>
    <div id="lastDonation" class="donation-item">–ü–æ—Å–ª–µ–¥–Ω–∏–π: ‚Äî</div>
    <div id="topDonation" class="donation-item">–¢–æ–ø: ‚Äî</div>
    <div id="totalAdded" class="donation-item">–í—Å–µ–≥–æ –ø—Ä–æ–¥–ª–µ–Ω–æ: 0 –º–∏–Ω</div>
    <div id="priceDisplay" class="price-tag">5—Ä = 1 –º–∏–Ω—É—Ç–∞</div>
    <div id="pricePopup" class="price-popup"></div>
</div>

</div>

<div class="admin">
–¶–µ–Ω–∞: <span id="adminPrice">5</span> —Ä—É–±<br>
<button onclick="changePrice(5)">+5—Ä</button>
<button onclick="changePrice(-5)">-5—Ä</button>
<hr>
<button onclick="addAdminTime(60)">+1 –º–∏–Ω</button>
<button onclick="addAdminTime(3600)">+1 —á–∞—Å</button>
<button onclick="addAdminTime(86400)">+1 –¥–µ–Ω—å</button>
</div>

<script>

let totalSeconds=600;
let topDonation=null;
let lastDonation=null;
let totalMinutesAdded=0;
let pricePerMinute=5;

/* TIMER */

function updateTimer(){
    if(totalSeconds>0) totalSeconds--;

    let d=Math.floor(totalSeconds/86400);
    let h=Math.floor((totalSeconds%86400)/3600);
    let m=Math.floor((totalSeconds%3600)/60);
    let s=totalSeconds%60;

    days.innerText=String(d).padStart(2,'0');
    hours.innerText=String(h).padStart(2,'0');
    minutes.innerText=String(m).padStart(2,'0');
    seconds.innerText=String(s).padStart(2,'0');

    if(totalSeconds<=60 && totalSeconds>0){
        timer.classList.add("danger");
    }else{
        timer.classList.remove("danger");
    }
}
setInterval(updateTimer,1000);

/* PRICE */

function updatePriceDisplay(){
    priceDisplay.innerText=pricePerMinute+"—Ä = 1 –º–∏–Ω—É—Ç–∞";
    adminPrice.innerText=pricePerMinute;
}

function changePrice(amount){
    let oldPrice=pricePerMinute;
    pricePerMinute+=amount;
    if(pricePerMinute<5) pricePerMinute=5;

    updatePriceDisplay();

    if(pricePerMinute>oldPrice){
        priceDisplay.classList.add("price-boost");
        pricePopup.innerHTML="üî• –¶–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞!";
        pricePopup.style.color="#ff4444";
    }else if(pricePerMinute<oldPrice){
        priceDisplay.classList.add("price-drop");
        pricePopup.innerHTML="üíô –¶–µ–Ω–∞ —Å–Ω–∏–∂–µ–Ω–∞!";
        pricePopup.style.color="#44aaff";
    }else return;

    pricePopup.classList.add("show");

    setTimeout(()=>{
        priceDisplay.classList.remove("price-boost");
        priceDisplay.classList.remove("price-drop");
        pricePopup.classList.remove("show");
    },1500);
}

/* DONATION LOGIC */

function addTime(seconds,nick,minutes){
    totalSeconds+=seconds;
    totalMinutesAdded+=minutes;

    lastDonation={nick,minutes};

    if(!topDonation || minutes>topDonation.minutes){
        topDonation={nick,minutes};
    }

    updateInfo();
}

function updateInfo(){
    if(lastDonation){
        lastDonation.innerHTML=`–ü–æ—Å–ª–µ–¥–Ω–∏–π: <span class="highlight">${lastDonation.nick}</span> ‚Äî ${lastDonation.minutes} –º–∏–Ω`;
    }
    if(topDonation){
        topDonation.innerHTML=`–¢–æ–ø: <span class="highlight">${topDonation.nick}</span> ‚Äî ${topDonation.minutes} –º–∏–Ω`;
    }
    totalAdded.innerText=`–í—Å–µ–≥–æ –ø—Ä–æ–¥–ª–µ–Ω–æ: ${totalMinutesAdded} –º–∏–Ω`;
}

function addAdminTime(seconds){
    addTime(seconds,"ADMIN",Math.floor(seconds/60));
}

/* ===== DONATIONALERTS SOCKET.IO ===== */

const socket = io("https://socket.donationalerts.ru:443", {
    transports: ["websocket"]
});

socket.on("connect", function() {
    console.log("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ DonationAlerts");

    socket.emit("add-user", {
        token: "Zvk2S9bNr4AujcccGrTs",
        type: "alert_widget"
    });
});

socket.on("donation", function(msg) {

    const nick = msg.username;
    const amount = parseFloat(msg.amount);

    if (amount < 5) return;

    const minutesAdded = Math.floor(amount / pricePerMinute);
    if (minutesAdded <= 0) return;

    addTime(minutesAdded * 60, nick, minutesAdded);
});

socket.on("disconnect", function() {
    console.log("üîå –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–æ—Ä–≤–∞–Ω–æ");
});

updatePriceDisplay();

</script>
</body>
</html>
